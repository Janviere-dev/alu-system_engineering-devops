#!/usr/bin/env bash
# Installs Nginx and configures a 301 redirect from /redirect_me to a YouTube URL

set -e

# Install Nginx silently
apt-get update -y
apt-get install nginx -y

# Backup default config (good practice)
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Inject the redirect block directly inside server context using sed
sed -i '/^\s*server {/a \    location /redirect_me {\n        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\n    }' /etc/nginx/sites-available/default

# Test config to ensure it's valid
nginx -t

# Restart Nginx using service (not systemctl)
service nginx restart

